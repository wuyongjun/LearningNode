webpackJsonp([22],{"7VRf":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("0GCx"),i=a("dE1y"),n=a.n(i),s=a("2fz3"),l=a("S6Tm"),r={data:function(){var e=this;return{messageOffset:0,startCountTimer:!1,sendVerifyCodeDisable:!0,sureButtonDisable:!0,countDownTime:0,verifyCodeButtonTitle:"发送验证码",chnageNameDialogFormData:{username:""},changePhoneDialogFormData:{phoneNum:"",verifyCode:""},changePasswordDialogFormData:{phoneNum:"",verifyCode:"",password:""},relativeUserHeaderImg:Object(l.e)("url"),userHeaderImg:n.a,username:Object(l.e)("real_name",""),userphone:Object(l.e)("user_name"),loginName:Object(l.e)("user_name"),hasPhone:""!==Object(l.e)("user_name")&&null!==Object(l.e)("user_name"),changePhoneBtText:"",loading:!1,upload_headers:{"Authentication-token":Object(l.e)("Authentication-token")},loginRules:{username:[{required:!0,trigger:"blur",validator:function(e,t,a){t?a():a(new Error("用户名不能为空"))}}],phoneNum:[{required:!0,trigger:"blur",validator:function(t,a,o){a?/^[1][3,4,5,7,8,9][0-9]{9}$/.test(a)?o():e.toastWarning("手机号格式不正确"):o(new Error("手机号不能为空"))}}],verifyCode:[{required:!0,trigger:"blur",validator:function(e,t,a){t?a():a(new Error("验证码不能为空"))}}],password:[{required:!0,trigger:"blur",validator:function(e,t,a){t?t.length<6?a(new Error("密码大于六位")):a():a(new Error("密码不能为空"))}}]},passwordType:"password",capsTooltip:!1,clickSpaceCloseDialog:!1,dialogTableVisible:!1,modifyPasswordDialogVisible:!1,modifyPhoneDialogVisible:!1,modifyUserNameDialogVisible:!1,modifyPortraitDialogVisible:!1,portraitData:[],portrait:""}},created:function(){var e=this;this.messageOffset=.4*screen.height,this.changePhoneBtText="换绑手机号";var t=Object(l.e)("url");t&&"null"!==t&&(this.userHeaderImg=Object(l.e)("url")),this.$store.dispatch("commitChangeTopTitles",["系统设置","修改密码"]),Object(s.g)("").then(function(t){e.portraitData=t.data})},mounted:function(){},methods:{updateInfo:function(e){var t=this;this.loading=!0;var a={};a.id=JSON.parse(sessionStorage.getItem("userInfo")).id,this.modifyPasswordDialogVisible?(a.password=e.changePasswordDialogFormData.password,a.user_name=e.changePasswordDialogFormData.phoneNum,a.code=String(e.changePasswordDialogFormData.verifyCode)):this.modifyPhoneDialogVisible?(a.user_name=e.changePhoneDialogFormData.phoneNum,a.code=String(e.changePhoneDialogFormData.verifyCode)):this.modifyUserNameDialogVisible?a.real_name=e.chnageNameDialogFormData.username:this.modifyPortraitDialogVisible&&(a.head_photo_id=this.portrait),Object(s.l)(a).then(function(a){e.loading=!1,"success"===a.status&&(t.username=a.data.real_name,t.userphone=a.data.user_name,t.userHeaderImg=a.data.head_photo.url,t.loginName=a.data.user_name,t.modifyPasswordDialogVisible?t.toastSuccess("修改密码成功!"):t.modifyPhoneDialogVisible?(t.toastSuccess("换绑手机号成功!"),Object(l.f)("user_name",a.data.user_name)):t.modifyUserNameDialogVisible?(Object(l.f)("real_name",a.data.real_name),t.toastSuccess("修改用户名成功!"),t.modifyUserNameDialogVisible=!1,o.a.$emit("updateUserName",a.data.real_name)):t.modifyPortraitDialogVisible&&(Object(l.f)("url",a.data.head_photo.url),t.toastSuccess("修改用户头像成功!"),t.modifyPortraitDialogVisible=!1,o.a.$emit("updateUserHeader",a.data.head_photo.url)),t.reset(),t.modifyPasswordDialogVisible=!1,t.modifyPhoneDialogVisible=!1,t.modifyUserNameDialogVisible=!1,t.modifyPortraitDialogVisible=!1)}).catch(function(t){e.loading=!1})},queryUserInfo:function(){},sentChangePhoneVerifyCode:function(e){var t=this;this.changePhoneDialogFormData.phoneNum?/^[1][3,4,5,7,8,9][0-9]{9}$/.test(this.changePhoneDialogFormData.phoneNum)?(this.countDownTime=60,this.sendVerifyCodeDisable=!1,this.startCountTimer=!0,this.timer(),Object(s.j)(this.changePhoneDialogFormData.phoneNum).then(function(e){t.loading=!1,"success"===e.status?(e.data&&(t.changePhoneDialogFormData.verifyCode=e.data,t.sureButtonDisable=!1),t.toastSuccess("发送验证码成功！")):t.loading=!1}).catch(function(e){this.loading=!1})):this.toastWarning("手机号格式不正确"):(this.sendVerifyCodeDisable=!0,this.toastWarning("请输入手机号"),this.sendVerifyCodeDisable=!0)},sentChangePasswordVerifyCode:function(e){var t=this;this.changePasswordDialogFormData.phoneNum?/^[1][3,4,5,7,8,9][0-9]{9}$/.test(this.changePasswordDialogFormData.phoneNum)?(this.countDownTime=60,this.sendVerifyCodeDisable=!1,this.startCountTimer=!0,this.timer(),Object(s.j)(this.changePasswordDialogFormData.phoneNum).then(function(e){t.loading=!1,"success"===e.status?(e.data&&(t.sureButtonDisable=!1),t.toastSuccess("发送验证码成功！")):t.loading=!1}).catch(function(e){this.loading=!1})):this.toastWarning("手机号格式不正确"):(this.sendVerifyCodeDisable=!0,this.toastWarning("请输入手机号"),this.sendVerifyCodeDisable=!0)},uploadImg:function(e){var t=this;Object(s.i)({upload_type:"admin"}).then(function(a){var o={host:a.data.host},i=new FormData,n=e.file.name.split(".")[e.file.name.split(".").length-1],l=t.$md5((new Date).getTime()+"_"+e.file.name);i.append("callback",a.data.callback),i.append("success_action_status","200"),i.append("OSSAccessKeyId",a.data.accessid),i.append("policy",a.data.policy),i.append("signature",a.data.signature),i.append("key",""+a.data.dir+l+"."+n),i.append("host",a.data.host),i.append("file",e.file),i.append("expire",a.data.expire),i.append("name",l+"."+n),o.fd=i,Object(s.m)(o.host,o.fd).then(function(e){t.userHeaderImg=e.filename,t.relativeUserHeaderImg=e.filename,t.updateInfo(t)}).catch(function(e){})}).catch(function(e){})},beforeAvatarUpload:function(e){var t=e.size/1024/1024<1;return t||this.$alert("上传头像图片大小不能超过 1MB!","消息提示",{confirmButtonText:"确定",callback:function(e){}}),t},handleError:function(){this.$alert("头像上传失败！","消息提示",{confirmButtonText:"确定",callback:function(e){}})},onPhoneInput:function(e){this.onInput(e);e&&/^[1][3,4,5,7,8,9][0-9]{9}$/.test(e)?this.sendVerifyCodeDisable=!1:this.sendVerifyCodeDisable=!0},onInput:function(e){this.modifyPasswordDialogVisible?this.changePasswordDialogFormData.phoneNum&&this.changePasswordDialogFormData.verifyCode&&this.changePasswordDialogFormData.password&&(this.sureButtonDisable=!1):this.modifyPhoneDialogVisible?this.changePhoneDialogFormData.phoneNum&&this.changePhoneDialogFormData.verifyCode&&(this.sureButtonDisable=!1):this.modifyUserNameDialogVisible&&this.chnageNameDialogFormData.username&&(this.sureButtonDisable=!1)},checkPhone:function(e){/^[1][3,4,5,7,8,9][0-9]{9}$/.test(e)?this.sendVerifyCodeDisable=!1:(this.sendVerifyCodeDisable=!0,this.toastWarning("手机号格式不正确"))},timer:function(){if(this.startCountTimer&&this.countDownTime>0){this.verifyCodeButtonTitle=this.countDownTime+"s后重新获取",this.sendVerifyCodeDisable=!0,this.countDownTime--;setTimeout(this.timer,1e3)}else this.countDownTime=0,this.verifyCodeButtonTitle="获取验证码",this.sendVerifyCodeDisable=!1},toastSuccess:function(e){this.$message({type:"success",message:e,center:!0,offset:this.messageOffset})},toastWarning:function(e){this.$message({type:"warning",message:e,center:!0,offset:this.messageOffset})},beforeCloseDialog:function(e){this.reset(),e()},reset:function(){this.startCountTimer=!1,this.sendVerifyCodeDisable=!0,this.sureButtonDisable=!0,this.countDownTime=60,this.chnageNameDialogFormData.username="",this.changePhoneDialogFormData.phoneNum="",this.changePhoneDialogFormData.verifyCode="",this.changePasswordDialogFormData.phoneNum="",this.changePasswordDialogFormData.verifyCode="",this.changePasswordDialogFormData.password="",this.verifyCodeButtonTitle="发送验证码",this.modifyPasswordDialogVisible?this.$refs.changePasswordDialogFormData.resetFields():this.modifyPhoneDialogVisible?this.$refs.changePhoneDialogFormData.resetFields():this.modifyUserNameDialogVisible&&this.$refs.chnageNameDialogFormData.resetFields()},checkCapslock:function(){},checkModifyUserName:function(){var e=this;this.$refs.chnageNameDialogFormData.validate(function(t){t?e.updateInfo(e):e.toastWarning("修改用户名失败!")})},checkModifyPhone:function(){var e=this;this.$refs.changePhoneDialogFormData.validate(function(t){t?e.updateInfo(e):e.toastWarning("换绑手机号失败!")})},checkModifyPassword:function(){var e=this;this.$refs.changePasswordDialogFormData.validate(function(t){t?e.updateInfo(e):e.toastWarning("修改密码失败!")})},portraitClick:function(e){this.portrait=e},updatePortrait:function(){this.userHeaderImg=this.portrait,this.relativeUserHeaderImg=this.portrait,this.updateInfo(this)}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{"margin-top":"30px","text-align":"center"}},[a("div",[a("el-image",{staticStyle:{width:"90px",height:"90px","border-radius":"50%","object-fit":"cover"},attrs:{src:e.userHeaderImg,fit:"scale-down"},on:{click:function(t){e.modifyPortraitDialogVisible=!0}}})],1),e._v(" "),a("label",{staticStyle:{color:"#666666","font-size":"30px","font-weight":"bold","margin-top":"16px","margin-bottom":"19px"}},[e._v("个人资料")]),e._v(" "),a("hr",{staticStyle:{width:"650px",height:"1px","background-color":"#DFDFDF",border:"none","margin-bottom":"34px"}}),e._v(" "),a("div",{staticStyle:{margin:"0 auto",display:"inline-block","text-align":"center"}},[a("label",{staticClass:"style_text_title"},[e._v("用户名   ")]),e._v(" "),a("label",{staticClass:"style_text_vlaue"},[e._v(e._s(e.username))]),e._v(" "),a("label",{staticClass:"style_modify_button",attrs:{slot:"append"},on:{click:function(t){e.modifyUserNameDialogVisible=!0}},slot:"append"},[e._v("修改")])]),e._v(" "),a("div",{staticStyle:{margin:"0 auto",display:"inline-block","text-align":"center"}},[a("label",{staticClass:"style_text_title"},[e._v("登录账号")]),a("label",{staticClass:"style_text_vlaue"},[e._v(e._s(e.loginName))]),e._v(" "),a("label",{staticClass:"style_modify_phone_button",attrs:{slot:"append"},on:{click:function(t){e.modifyPhoneDialogVisible=!0}},slot:"append"},[e._v(e._s(e.changePhoneBtText))])]),e._v(" "),a("div",[a("el-button",{staticClass:"style_sure_button",on:{click:function(t){e.modifyPasswordDialogVisible=!0}}},[e._v("修改密码")])],1),e._v(" "),a("div",{staticClass:"divider"}),e._v(" "),a("el-dialog",{staticClass:"style_dialog",attrs:{title:"修改密码","show-close":!0,visible:e.modifyPasswordDialogVisible,"close-on-click-modal":e.clickSpaceCloseDialog,"before-close":e.beforeCloseDialog},on:{"update:visible":function(t){e.modifyPasswordDialogVisible=t}}},[a("el-form",{ref:"changePasswordDialogFormData",staticClass:"style_dialog_content",attrs:{model:e.changePasswordDialogFormData,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[a("el-form-item",{attrs:{prop:"phoneNum"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"请输入用户手机号","prefix-icon":"el-icon-mobile-phone",name:"phoneNum",type:"phone",tabindex:"1"},on:{input:e.onPhoneInput},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkModifyPassword(t)}},model:{value:e.changePasswordDialogFormData.phoneNum,callback:function(t){e.$set(e.changePasswordDialogFormData,"phoneNum",t)},expression:"changePasswordDialogFormData.phoneNum"}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[a("el-form-item",{attrs:{prop:"verifyCode"}},[a("el-input",{attrs:{placeholder:"请输入手机验证码","prefix-icon":"el-icon-message",name:"verifyCode",tabindex:"2"},on:{input:e.onInput},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkModifyPassword(t)}},model:{value:e.changePasswordDialogFormData.verifyCode,callback:function(t){e.$set(e.changePasswordDialogFormData,"verifyCode",t)},expression:"changePasswordDialogFormData.verifyCode"}},[a("el-button",{attrs:{slot:"append",disabled:e.sendVerifyCodeDisable},nativeOn:{click:function(t){return t.preventDefault(),e.sentChangePasswordVerifyCode(t)}},slot:"append",model:{value:e.verifyCodeButtonTitle,callback:function(t){e.verifyCodeButtonTitle=t},expression:"verifyCodeButtonTitle"}},[e._v("\n              "+e._s(e.verifyCodeButtonTitle)+"\n            ")])],1)],1)],1),e._v(" "),a("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{key:e.passwordType,ref:"password",attrs:{placeholder:"请输入密码","prefix-icon":"el-icon-lock",type:e.passwordType,name:"password",tabindex:"3",autocomplete:"on"},on:{blur:function(t){e.capsTooltip=!1},input:e.onInput},nativeOn:{keyup:[function(t){return e.checkCapslock(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkModifyPassword(t)}]},model:{value:e.changePasswordDialogFormData.password,callback:function(t){e.$set(e.changePasswordDialogFormData,"password",t)},expression:"changePasswordDialogFormData.password"}})],1)],1),e._v(" "),a("div",[a("el-button",{staticClass:"style_dialog_sure_button",attrs:{disabled:e.sureButtonDisable},nativeOn:{click:function(t){return t.preventDefault(),e.checkModifyPassword(t)}}},[e._v("确定")])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"style_dialog",attrs:{title:e.changePhoneBtText,visible:e.modifyPhoneDialogVisible,"show-close":!0,"close-on-click-modal":e.clickSpaceCloseDialog,"before-close":e.beforeCloseDialog},on:{"update:visible":function(t){e.modifyPhoneDialogVisible=t}}},[a("el-form",{ref:"changePhoneDialogFormData",staticClass:"style_dialog_content",attrs:{model:e.changePhoneDialogFormData,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[a("el-form-item",{attrs:{prop:"phoneNum"}},[a("el-input",{attrs:{maxlength:"11",placeholder:"请输入用户手机号","prefix-icon":"el-icon-mobile-phone",name:"phoneNum",type:"phone",tabindex:"1"},on:{input:e.onPhoneInput},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkModifyPhone(t)}},model:{value:e.changePhoneDialogFormData.phoneNum,callback:function(t){e.$set(e.changePhoneDialogFormData,"phoneNum",t)},expression:"changePhoneDialogFormData.phoneNum"}})],1),e._v(" "),a("el-tooltip",{attrs:{content:"Caps lock is On",placement:"right",manual:""},model:{value:e.capsTooltip,callback:function(t){e.capsTooltip=t},expression:"capsTooltip"}},[a("el-form-item",{attrs:{prop:"verifyCode"}},[a("el-input",{attrs:{placeholder:"请输入手机验证码","prefix-icon":"el-icon-message",name:"verifyCode",tabindex:"2"},on:{input:e.onInput},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkModifyPhone(t)}},model:{value:e.changePhoneDialogFormData.verifyCode,callback:function(t){e.$set(e.changePhoneDialogFormData,"verifyCode",t)},expression:"changePhoneDialogFormData.verifyCode"}},[a("el-button",{attrs:{slot:"append",disabled:e.sendVerifyCodeDisable},nativeOn:{click:function(t){return t.preventDefault(),e.sentChangePhoneVerifyCode(t)}},slot:"append",model:{value:e.verifyCodeButtonTitle,callback:function(t){e.verifyCodeButtonTitle=t},expression:"verifyCodeButtonTitle"}},[e._v(e._s(e.verifyCodeButtonTitle))])],1)],1)],1),e._v(" "),a("div",[a("el-button",{staticClass:"style_dialog_sure_button",attrs:{disabled:e.sureButtonDisable},nativeOn:{click:function(t){return t.preventDefault(),e.checkModifyPhone(t)}}},[e._v("确定")])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"style_dialog",attrs:{title:"修改用户名",visible:e.modifyUserNameDialogVisible,"show-close":!0,"close-on-click-modal":e.clickSpaceCloseDialog,"before-close":e.beforeCloseDialog},on:{"update:visible":function(t){e.modifyUserNameDialogVisible=t}}},[a("el-form",{ref:"chnageNameDialogFormData",staticClass:"style_dialog_content",attrs:{model:e.chnageNameDialogFormData,rules:e.loginRules,autocomplete:"on","label-position":"left"}},[a("el-form-item",{attrs:{prop:"username"}},[a("div",[a("label",{staticStyle:{width:"8px"}},[e._v("用户名：")]),e._v(" "),a("el-input",{ref:"username",staticStyle:{width:"100%"},attrs:{maxlength:"11",placeholder:"请输入新用户名",type:"text",name:"username",tabindex:"1"},on:{input:e.onInput},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.checkModifyUserName(t)}},model:{value:e.chnageNameDialogFormData.username,callback:function(t){e.$set(e.chnageNameDialogFormData,"username",t)},expression:"chnageNameDialogFormData.username"}})],1)]),e._v(" "),a("div",[a("el-button",{staticClass:"style_dialog_sure_button",attrs:{disabled:e.sureButtonDisable},nativeOn:{click:function(t){return t.preventDefault(),e.checkModifyUserName(t)}}},[e._v("\n          确定\n        ")])],1)],1)],1),e._v(" "),a("el-dialog",{staticClass:"style_dialog_portrait",attrs:{title:"修改头像",visible:e.modifyPortraitDialogVisible,"show-close":!0,"close-on-click-modal":e.clickSpaceCloseDialog,"before-close":e.beforeCloseDialog},on:{"update:visible":function(t){e.modifyPortraitDialogVisible=t}}},[a("el-form",[e._l(e.portraitData,function(t){return a("img",{key:t.id,staticStyle:{width:"45px",height:"45px",margin:"12px"},attrs:{src:t.url,alt:""},on:{click:function(a){return e.portraitClick(t.id)}}})}),e._v(" "),a("div",[a("el-button",{staticClass:"style_dialog_sure_button",on:{click:e.updatePortrait}},[e._v("\n          确定\n        ")])],1)],2)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(r,c,!1,function(e){a("VVFJ")},"data-v-727ea5da",null);t.default=d.exports},VVFJ:function(e,t){}});
//# sourceMappingURL=22.29203d5f7c3a88f9e392.js.map